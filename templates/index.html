<!doctype html>
<html class="base" lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>CNABEngine Validator</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='styles/css/index.css') }}"
    />
  </head>
  <body class="container">
    <header class="container-header">
      <h2 class="header-title">CNABEngine</h2>
      <p class="header-body">
        Plataforma desenvolvida para validação de arquivos CNAB de Remessa e
        Retorno, conforme especificação do layout CNAB 400 do Banco do Brasil.
      </p>
    </header>

    <main class="container-card">
      <section class="card">
        <form
          method="post"
          enctype="multipart/form-data"
          class="container-file"
        >
          <div class="file-input">
            <input
              type="file"
              id="file"
              name="file"
              accept=".rem, .ret"
              required
              hidden
            />
            <label for="file" class="file-button">Selecionar Arquivo</label>

            <div class="file-info" id="fileInfo" style="display: none">
              <span class="file-name" id="fileName"></span>
              <button class="remove-button" type="button" id="removeFile">
                ✕
              </button>
            </div>
          </div>

          <div class="actions">
            <button type="submit" id="submit" class="submit-button">
              Validar Arquivo
            </button>
            <a
              href="{{ url_for('clear') }}"
              class="clear-button {% if not result.file_name %}disabled{% endif %}"
            >
              Limpar Validação
            </a>
            <a
              href="{{ url_for('export') }}"
              class="export-button {% if not result.file_name %}disabled{% endif %}"
              >Exportar</a
            >
          </div>
        </form>
      </section>
    </main>

    {% if show_result %}
    <section class="summary">
      <div class="summary-card">
        <span class="label">Nome do Arquivo</span>
        <span class="value">{{ result.file_name }}</span>
      </div>

      <div class="summary-card">
        <span class="label">Tipo de Arquivo</span>
        <span class="value">{{ result.file_type }}</span>
      </div>

      <div class="summary-card">
        <span class="label">Data da Validação</span>
        <span class="value">{{ result.validation_date }}</span>
      </div>

      <div class="summary-card">
        <span class="label">Linhas Avaliadas</span>
        <span class="value">{{ result.total_lines }}</span>
      </div>

      <div class="summary-card errors">
        <span class="label">Total de Erros</span>
        <span class="value">{{ result.total_errors or 0 }}</span>
      </div>
    </section>
    {% endif %} {% if result.grouped_errors %}
    <section class="result error">
      {% for context, messages in result.grouped_errors.items() %}
      <div class="error-group">
        <h3>{{ context }}</h3>
        <ul>
          {% for msg in messages %}
          <li>{{ msg }}</li>
          {% endfor %}
        </ul>
      </div>
      {% endfor %}
    </section>
    {% endif %}

    <footer class="container-footer">
      <p class="footer-content">CNABEngine © 2026</p>
    </footer>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
  </body>
</html>
